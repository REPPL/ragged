# v0.4.6 - Behaviour Learning & Personalisation

**Hours**: 35-40 | **Priority**: P0 - Core Feature | **Status**: Planned

**Dependencies**: v0.4.5 complete (Stable memory system)

---

## Overview

Implement intelligent behaviour learning and personalised ranking based on user interactions and interests.

**Vision**: Ragged learns from user patterns and automatically improves relevance over time.

**Theoretical Foundation**: Applies [Context Engineering 2.0](../../../acknowledgements/context-engineering-2.0.md) **context-aware retrieval** principles—moving beyond keyword matching to select context based on learned user interests. Personalised ranking reduces uncertainty (entropy reduction) by prioritising information aligned with user focus areas and historical behaviour.

---

## Core Deliverables

### 1. Topic Extraction (4h)

Extract topics from queries for interest profiling.

**Phase 1**: Simple keyword extraction
**Future**: NLP/LLM-based extraction

**Files**:
- `ragged/memory/topics.py` (~200 lines)
- `tests/memory/test_topics.py` (~150 lines)

---

### 2. Behaviour Learner (12h)

Learn from user interaction patterns.

**Features**:
- Track topics queried
- Track documents accessed
- Build interest profiles
- Detect co-occurring topics
- Calculate confidence scores

**Files**:
- `ragged/memory/behaviour.py` (~350 lines)
- `tests/memory/test_behaviour.py` (~200 lines)

---

### 3. Personalised Ranking (10h)

Re-rank results using personal context.

**Algorithm**:
1. Get user interest profile
2. Boost docs related to focus topics
3. Boost previously accessed docs
4. Apply time decay (recent interests weighted more)

**Files**:
- `ragged/memory/personalisation.py` (~200 lines)
- `tests/memory/test_personalization.py` (~150 lines)

---

### 4. RAG Pipeline Integration (8h)

Integrate memory into query flow.

**Enhanced Pipeline**:
```python
query() ->
  switch_persona() ->
  enhance_with_context() ->
  retrieve(k*2) ->
  personalized_rerank(k) ->
  generate() ->
  record_interaction()
```

**Modified**:
- `ragged/core/retrieval.py`
- `ragged/main.py`

---

### 5. Testing & Validation (6-8h)

Validate personalization improvements.

**Tests**:
- Unit tests for each component
- Integration tests for full pipeline
- Manual validation of relevance
- A/B testing infrastructure

---

## Success Criteria

Version 0.4.6 is successful if:

1. ✅ Personalization improves relevance by >15%
2. ✅ Topic extraction 80%+ accuracy
3. ✅ Interest profiles make sense to users
4. ✅ Performance <2s end-to-end
5. ✅ Memory enhancement transparent
6. ✅ Can disable personalization
7. ✅ 85%+ test coverage
8. ✅ Documentation complete

---

## Performance Targets

- Topic extraction: <50ms
- Profile building: <200ms
- Personalized reranking: <100ms
- End-to-end query: <2s

---

## File Summary

**New Files** (~1,750 lines):
- Behaviour learning: ~750 lines
- Tests: ~500 lines
- Documentation: ~500 lines

---

## Related Documentation

- [v0.4.0 Detailed Spec](v0.4.0-DETAILED-SPEC.md) - Part 2: Milestone 2
- [v0.4.5](v0.4.5.md) - Stability (previous)
- [v0.4.7](v0.4.7.md) - Refactoring (next)

---

**License**: GPL-3.0 | **Updated**: 2025-11-18
