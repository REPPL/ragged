# v0.3.6 - Messy Document Intelligence

**Category:** Automated Document Correction & Exceptional Markdown (KILLER FEATURE)

**Estimated Time:** 49-57 hours

**Status:** Planned

---

## Overview

Fully automated messy PDF handling with exceptional markdown conversion - **hidden from user**.

---

## Features

### FEAT-021: PDF Analysis & Detection (12-15h)

Auto-detect rotation, page ordering, duplicates, missing pages, quality scoring.

**Hidden from user** - automatic background processing.

### FEAT-022: Automated PDF Correction (14-16h)

- Auto-rotate based on text orientation
- Auto-reorder based on detected page numbers
- Remove duplicate pages
- Insert placeholders for missing pages
- **Store corrected version in library** (not original)

### FEAT-023: Exceptional Markdown Conversion (6-7h)

- Structure detection (headings, lists, tables, footnotes)
- Figure and caption extraction
- LaTeX equation preservation
- Citation format detection
- Page numbers as `<!-- Page N -->` comments
- OCR confidence tracking per section
- Uncertain text marked: `[?unclear?]`
- Default quality: "good" (98% OCR confidence)

---

## User Experience

```bash
ragged add messy_scanned_book.pdf

# System output:
# ✓ Detected scanned document
# ✓ Analysing quality... 87 pages, 12 rotated, 3 duplicates
# ✓ Auto-correcting... rotated 12 pages, removed 3 duplicates
# ✓ Reordering pages... detected page numbers
# ✓ Storing corrected version in library
# ✓ Converting to exceptional markdown... 98% confidence
# ✓ Added to library with 847 chunks

# Optional: Get the corrected PDF
ragged export pdf messy_scanned_book.pdf --corrected
```

---

## Storage Strategy

- **Original PDF:** Stays where user has it (external drive, etc.)
- **Corrected PDF:** Stored in library (`data/documents/corrected/`)
- **Markdown:** Stored in library (`data/documents/markdown/`)
- **Metadata:** Tracks corrections applied

---

## Dependencies (Additional)

```toml
pypdf = "^3.17.0"               # BSD - PDF manipulation
img2pdf = "^0.5.1"              # LGPL - Image to PDF
scikit-image = "^0.22.0"        # BSD - Image quality assessment
```

---

## Agent Workflow (14-16h)

1. **architecture-advisor (3h):** Correction architecture review
2. **ux-architect (2h):** Markdown quality design review
3. **documentation-architect (4h):** User guides + pipeline docs
4. **documentation-auditor (3-4h):** Comprehensive review
5. **git-documentation-committer (2-3h):** Commit

---

## Deliverables

- Fully automated PDF correction
- Exceptional markdown conversion
- 98% OCR confidence default
- Hidden correction workflow

---

**Status:** Planned
