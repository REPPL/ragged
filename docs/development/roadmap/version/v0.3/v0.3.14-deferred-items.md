# v0.3.14 Roadmap: Deferred Items & Technical Debt

**Category:** Cleanup & Quality Improvements
**Status:** Planned
**Priority:** MEDIUM
**Estimated Time:** 150+ hours (across multiple sub-versions if needed)

---

## Overview

This roadmap captures deferred items from v0.3.3, v0.3.4a, and v0.3.4b implementations, including security hardening, integration work, test fixes, and quality improvements.

---

## CRITICAL Priority Items

### 1. Security Hardening (v0.3.4a and v0.3.4b)

**From:** Security audits conducted 2025-11-20

#### v0.3.4a Security Fixes (37 hours)

**Grade:** C+ → Target B+

**Phase 1 (11 hours):**
- CRITICAL-001: Implement file size validation before processing
- HIGH-001: Add MIME type verification (magic bytes check)
- HIGH-002: Implement processing timeouts

**Phase 2 (15 hours):**
- HIGH-003: Model integrity verification (SHA-256 checksums)
- MEDIUM-001: Error message sanitisation
- MEDIUM-002: File permissions validation

**Phase 3 (11 hours):**
- All remaining MEDIUM issues
- Fuzzing test development
- Security documentation updates

**Documents:**
- [v0.3.4a Security Audit](../../security/v0.3.4a-security-audit.md)
- [v0.3.4a Security Tests](../../../tests/security/test_v0.3.4a_docling.py)

#### v0.3.4b Security Fixes (62 hours)

**Grade:** C → Target B+ → A-

**Phase 1 (5 days / ~40 hours):**
- CRITICAL-1: Replace MD5 with SHA-256 for cache keys
- CRITICAL-2: Add page/image processing resource limits
- CRITICAL-3: Fix metrics file permissions (0600)
- HIGH-5: Input validation for all paths

**Phase 2 (5 days / ~40 hours):**
- HIGH-4: Storage directory path validation
- HIGH-6: Configuration validation in RouterConfig
- HIGH-7: Processor registration type checking
- MEDIUM-8: Rate limiting on quality assessments

**Phase 3 (4 days / ~32 hours):**
- All MEDIUM issues (error handling, cache security, logging privacy)
- Improve fallback assessment
- Secure metrics deletion

**Phase 4 (5 days / ~40 hours):**
- Comprehensive security test suite
- Fuzzing tests for quality assessment
- Integration security tests
- Security documentation

**Documents:**
- [v0.3.4b Security Audit](../../security/v0.3.4b-security-audit.md)
- [v0.3.4b Security Tests](../../../tests/security/test_v0.3.4b_routing.py)

**Total Security Hardening:** 99 hours (v0.3.4a: 37h + v0.3.4b: 62h)

---

## HIGH Priority Items

### 2. v0.3.3 Chunking Integration

**Status:** Implementation complete, NOT integrated into pipeline
**Estimated:** 20-25 hours

**What's Missing:**
1. CLI option additions (`--chunking-strategy semantic|hierarchical|fixed`)
2. Configuration file support for chunking strategy selection
3. Ingestion pipeline modifications to use new chunkers
4. Retrieval system updates (fetch parent chunks for hierarchical)
5. Integration tests for end-to-end chunking workflow

**Files to Modify:**
- `src/cli.py` - Add chunking strategy options
- `src/config/settings.py` - Add chunking configuration
- `src/ingestion/` - Integrate semantic/hierarchical chunkers
- `src/retrieval/` - Update for hierarchical parent fetching
- `tests/integration/` - End-to-end chunking tests

**Impact:** 666 lines of chunking code currently unusable by end users

**Benefits:**
- 5-10% retrieval precision improvement (estimated)
- 10-15% answer completeness improvement (estimated)
- User choice of chunking strategy

**Risks:**
- Breaking changes to ingestion pipeline
- Retrieval system complexity increase
- Performance impact needs measurement

**Documents:**
- [v0.3.3 Implementation Summary](../../implementation/version/v0.3/v0.3.3/summary.md)
- [v0.3.3 Lineage](../../implementation/version/v0.3/v0.3.3/lineage.md)

---

### 3. Fix 8 Failing v0.3.4b Integration Tests

**Status:** Tests failing, integration incomplete
**Estimated:** 6-8 hours

**Issue:** Mock patterns incompatible with lazy-loaded quality assessor

**Root Cause:**
- Quality assessor uses lazy loading for PyMuPDF and OpenCV
- Integration tests mock these dependencies
- Mock strategy doesn't account for lazy initialization

**Fix Strategy:**
1. Investigate actual vs expected mock behavior (2h)
2. Update mock patterns for lazy-loaded components (2h)
3. Ensure tests reflect real behavior (1h)
4. Update test documentation (1h)

**Affected Files:**
- `tests/processing/` integration tests (8 failing)
- Possibly `src/processing/quality_assessor.py` if test reveals issues

**Success Criteria:**
- All integration tests pass
- Tests accurately reflect production behavior
- CI/CD pipeline green

---

## MEDIUM Priority Items

### 4. Dependency Security Updates

**From:** [Dependency Scan](../../security/dependency-scan.md)

**Issue:** urllib3 2.3.0 has 2 MEDIUM vulnerabilities
**Fix:** Upgrade to urllib3 2.5.0

**Effort:** 2 hours
- Update `pyproject.toml` (15 min)
- Test with updated dependency (1h)
- Verify fix with pip-audit (15 min)
- Update documentation (30 min)

**Risk:** LOW for ragged (local-only operation, no external HTTP in normal use)

**Timeline:** Next maintenance window (within 2 weeks recommended)

---

### 5. Performance Benchmarking

**From:** v0.3.3 and v0.3.4a implementation summaries

**Missing:** Actual performance measurements for:
- Semantic chunking overhead per document
- Hierarchical chunking memory usage
- Docling processing time (born-digital vs scanned)
- Quality assessment overhead

**Effort:** 10-12 hours
- Set up benchmarking framework (4h)
- Benchmark semantic/hierarchical chunking (2h)
- Benchmark Docling vs pymupdf (2h)
- Benchmark quality assessment (2h)
- Document results and compare to estimates (2h)

**Deliverables:**
- `docs/development/benchmarks/` directory
- Performance comparison reports
- Validation of estimated improvements

---

### 6. RAGAS Quality Evaluation

**From:** v0.3.3 planning (quality improvement claims need validation)

**Missing:** Actual RAGAS measurements for:
- Semantic chunking retrieval precision (claimed 5-10%)
- Hierarchical chunking answer completeness (claimed 10-15%)

**Effort:** 8-10 hours
- Integrate v0.3.3 chunking first (prerequisite)
- Generate test dataset (2h)
- Run RAGAS evaluation (2h)
- Compare fixed vs semantic vs hierarchical (2h)
- Document findings (2h)

**Deliverables:**
- RAGAS evaluation reports
- Validation (or invalidation) of improvement claims
- Recommendations for threshold tuning

---

### 7. Code Quality Audit

**Items:**
- British English compliance check (automated)
- Type hint completeness verification (mypy --strict)
- Docstring completeness check
- Dead code removal
- Import optimization

**Effort:** 6-8 hours

**Tools:**
- `/check-british` command
- `mypy --strict`
- Custom docstring checker
- Code coverage analysis

---

## LOW Priority Items

### 8. Documentation Polish

**Items:**
- Spell check all documentation
- Verify all cross-references
- Generate API documentation (pdoc)
- Create architectural diagrams
- User guide updates

**Effort:** 12-15 hours

---

### 9. Test Coverage Improvements

**From:** Security test suite creation

**Gaps:**
- Edge case tests (Unicode, emoji, mixed language)
- Property-based tests (Hypothesis)
- Stress tests (large files, many pages)
- Concurrent access tests

**Effort:** 15-20 hours

---

### 10. Developer Experience Improvements

**Items:**
- Better error messages in CLI
- Progress indicators for long operations
- Debug mode with verbose logging
- Developer documentation

**Effort:** 10-12 hours

---

## Future Versions (v0.4.x)

### Deferred to v0.4.x

**Large-Scale Refactoring:**
- Multi-language support for chunking
- Custom embedding model configuration
- GPU acceleration for embeddings
- Distributed processing
- Advanced routing strategies

**New Features:**
- Multi-modal RAG (images, tables as first-class)
- Cross-document relationships
- Temporal awareness (document versioning)
- Collaborative features (multi-user)

---

## Prioritization Matrix

| Item | Priority | Effort | Impact | Sequence |
|------|----------|--------|--------|----------|
| v0.3.4b Security (Phase 1) | CRITICAL | 40h | Security | 1 |
| v0.3.4a Security (Phase 1) | CRITICAL | 11h | Security | 2 |
| Fix 8 failing tests | HIGH | 6-8h | CI/CD | 3 |
| v0.3.3 Integration | HIGH | 20-25h | User value | 4 |
| v0.3.4b Security (Phase 2-4) | HIGH | 112h | Security | 5 |
| v0.3.4a Security (Phase 2-3) | MEDIUM | 26h | Security | 6 |
| Dependency updates | MEDIUM | 2h | Maintenance | 7 |
| Performance benchmarking | MEDIUM | 10-12h | Validation | 8 |
| RAGAS evaluation | MEDIUM | 8-10h | Validation | 9 |
| Code quality audit | LOW | 6-8h | Maintenance | 10 |
| Test coverage | LOW | 15-20h | Quality | 11 |
| Documentation polish | LOW | 12-15h | Quality | 12 |

**Total Estimated Effort:** ~280-300 hours

---

## Recommended Breakdown

### v0.3.14a: Critical Security Fixes (Sprint 1-2)

**Duration:** 2 weeks
**Effort:** 51 hours

1. v0.3.4b Security Phase 1 (40h)
2. v0.3.4a Security Phase 1 (11h)

**Deliverable:** Both versions upgraded to B+ security grade

---

### v0.3.14b: Integration & Test Fixes (Sprint 3)

**Duration:** 1 week
**Effort:** 26-33 hours

1. Fix 8 failing integration tests (6-8h)
2. v0.3.3 chunking integration (20-25h)

**Deliverable:** All tests passing, chunking strategies usable

---

### v0.3.14c: Remaining Security & Validation (Sprint 4-6)

**Duration:** 3 weeks
**Effort:** 138-146 hours

1. v0.3.4b Security Phase 2-4 (112h)
2. v0.3.4a Security Phase 2-3 (26h)

**Deliverable:** A- security grade, production-ready

---

### v0.3.14d: Quality & Validation (Sprint 7-8)

**Duration:** 2 weeks
**Effort:** 20-24 hours

1. Dependency updates (2h)
2. Performance benchmarking (10-12h)
3. RAGAS evaluation (8-10h)

**Deliverable:** Validated performance claims, secure dependencies

---

### v0.3.15: Polish & Cleanup (Ongoing)

**Duration:** Ongoing maintenance
**Effort:** 33-43 hours

1. Code quality audit (6-8h)
2. Test coverage improvements (15-20h)
3. Documentation polish (12-15h)

**Deliverable:** Production-grade quality

---

## Related Documentation

- [v0.3.3 Implementation](../../implementation/version/v0.3/v0.3.3/summary.md)
- [v0.3.4a Security Audit](../../security/v0.3.4a-security-audit.md)
- [v0.3.4b Security Audit](../../security/v0.3.4b-security-audit.md)
- [Dependency Scan](../../security/dependency-scan.md)

---

**Status:** Planned
**Next Action:** Execute v0.3.14a (Critical Security Fixes)
**Target Start:** After v0.3.4b completion
