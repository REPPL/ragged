# v0.3.4c - PaddleOCR (Optional)

**Category:** Modern Document Processing - Phase 3

**Estimated Time:** 15-18 hours

**Status:** Planned

---

## Overview

Implement optional PaddleOCR integration as a specialised fallback processor for challenging documents with poor quality, rotated text, or heavy degradation. This phase completes the v0.3.4 modern document processing initiative by providing best-in-class OCR for edge cases whilst keeping the complexity optional for users who don't need it.

**Current State:** Intelligent routing with Docling-only processing (v0.3.4b)

**Target State:** Multi-processor routing with optional PaddleOCR fallback for messy documents

**Benefits:**
- Best-in-class OCR for degraded documents (PaddleOCR accuracy)
- Unique rotated text handling (PaddleOCR angle classification)
- 80+ language support for multilingual documents
- Optional installation (users choose complexity vs capability)
- Graceful degradation (works without PaddleOCR installed)
- Complete fallback chain: Docling → PaddleOCR → Legacy

**Why Optional:**
- Installation complexity (C++ dependencies, CUDA for GPU)
- Python 3.12 compatibility concerns (recent support, not fully proven)
- Large dependency footprint (~500MB for PaddlePaddle framework)
- Most users won't need it (Docling handles 95% of documents well)
- Privacy-first users avoid any cloud alternatives, so local complexity justified

**Why After v0.3.4b:**
- Routing infrastructure already proven with single processor
- Quality assessment validated and tuned
- Clear triggering conditions for PaddleOCR (quality < 0.70)
- Easier debugging with established baseline

---

## Prerequisites

**Required Implementations:**

- ✅ **v0.3.4a (Docling Core)** - Provides primary processor and architecture
- ✅ **v0.3.4b (Intelligent Routing)** - Provides quality assessment and routing logic

**Security & Privacy Foundation:**

- ✅ **v0.2.10 (Security Hardening)** - Session isolation, security testing
- ✅ **v0.2.11 (Privacy Infrastructure)** - Encryption, PII detection, GDPR compliance

**Technical Foundation:**

- ✅ **v0.3.3 (Intelligent Chunking)** - Semantic and hierarchical chunking for processed content

**Why Required:** PaddleOCR integration depends entirely on the processor architecture (v0.3.4a) and routing logic (v0.3.4b). This phase is purely additive - it registers a new processor into the existing framework.

---

## Features

### FEAT-011: PaddleOCR Processor (12h)

**Priority:** Optional Enhancement
**Dependencies:** v0.3.4a (processor architecture), v0.3.4b (routing logic)

#### Scope

Implement PaddleOCR as an optional processor for documents that Docling struggles with, particularly:
- Heavily degraded scanned documents
- Rotated or skewed text (unique PaddleOCR capability)
- Low-resolution scans with poor contrast
- Handwritten annotations (limited support)
- Multilingual documents (80+ languages)

**PaddleOCR Advantages:**
- Angle classification (automatically corrects rotated text)
- Superior accuracy on degraded/noisy images
- Extensive language support (80+ languages vs Docling's focus on common languages)
- Layout analysis (text detection → angle classification → recognition → structure recovery)

**PaddleOCR Limitations:**
- Installation complexity (C++ dependencies)
- Large framework (~500MB for PaddlePaddle)
- Slower than Docling (OCR is compute-intensive)
- Python 3.12 compatibility recently added (needs validation)

#### Implementation Overview

- **Module:** `src/processing/paddleocr_processor.py`
- **Approach:** Conditional import with graceful fallback, implements `BaseProcessor` interface
- **Libraries:** paddleocr, paddlepaddle (both Apache 2.0 licence)
- **Strategy:** Plugin registration, quality-based routing, preprocessing pipeline

#### Key Components

```python
# Conditional import pattern
try:
    from paddleocr import PaddleOCR
    PADDLEOCR_AVAILABLE = True
except ImportError:
    PADDLEOCR_AVAILABLE = False
    logger.info(
        "PaddleOCR not installed. Install with: "
        "pip install paddleocr paddlepaddle"
    )


class PaddleOCRProcessor(BaseProcessor):
    """PaddleOCR-based processor for challenging documents"""

    def __init__(self, config: ProcessorConfig):
        super().__init__(config)

        if not PADDLEOCR_AVAILABLE:
            raise ImportError(
                "PaddleOCR not available. Install with: "
                "pip install paddleocr paddlepaddle"
            )

        self.ocr = PaddleOCR(
            use_angle_cls=True,      # Enable rotation detection
            lang=config.lang or 'en', # Default to English
            use_gpu=config.use_gpu,   # GPU acceleration (optional)
            show_log=False,           # Suppress verbose logging
            det_model_dir=config.model_cache_dir / 'det',
            rec_model_dir=config.model_cache_dir / 'rec',
            cls_model_dir=config.model_cache_dir / 'cls',
        )

    def process(self, file_path: Path) -> ProcessedDocument:
        """Process document with PaddleOCR"""
        # Convert PDF to images (page by page)
        pages = self._pdf_to_images(file_path)

        results = []
        for page_num, page_image in enumerate(pages):
            # Optional: preprocessing for better OCR
            if self.config.options.get('preprocess', True):
                page_image = self._preprocess_image(page_image)

            # Run PaddleOCR (detection → angle classification → recognition)
            ocr_result = self.ocr.ocr(page_image, cls=True)

            # Convert to structured format
            page_result = self._parse_ocr_result(ocr_result, page_num)
            results.append(page_result)

        # Combine pages into document
        return self._combine_pages(results, file_path)
```

#### PaddleOCR Processing Pipeline

```
PDF Document
    ↓
Convert pages to images (PyMuPDF)
    ↓
For each page image:
    │
    ├─ Optional preprocessing:
    │   ├─ Contrast enhancement (CLAHE)
    │   ├─ Noise reduction (bilateral filter)
    │   ├─ Binarisation (adaptive threshold)
    │   └─ Deskewing (if not rotated 90°)
    │
    ├─ Text detection (find text regions)
    │   └─ PaddleOCR detection model
    │
    ├─ Angle classification (detect rotation)
    │   └─ PaddleOCR angle classifier (0°, 90°, 180°, 270°)
    │
    ├─ Text recognition (OCR)
    │   └─ PaddleOCR recognition model
    │
    └─ Structure recovery (layout analysis)
        └─ Group text into lines, paragraphs, blocks
    ↓
Combine pages into markdown
    ↓
Return ProcessedDocument
```

---

### FEAT-012: Installation & Compatibility (3h)

**Priority:** Critical (for optional feature)
**Dependencies:** None

#### Scope

Ensure PaddleOCR installation is as smooth as possible despite inherent complexity, with comprehensive documentation, compatibility validation, and helpful error messages.

**Installation Challenges:**
- **C++ dependencies:** PaddleOCR requires C++ build tools (Windows: Visual Studio, Linux: gcc, macOS: Xcode)
- **Python 3.12:** Recently supported but not extensively tested
- **GPU support:** Optional CUDA setup for GPU acceleration
- **Model downloads:** Multiple models (~100MB total) download on first use

**Compatibility Matrix:**

| Platform | Python 3.12 | Installation | GPU Support | Status |
|----------|------------|--------------|-------------|--------|
| Linux | ✓ | Straightforward | CUDA 11.2+ | Recommended |
| macOS | ✓ | Requires Xcode CLI tools | CPU only | Supported |
| Windows | ⚠️ | Requires VS Build Tools | CUDA 11.2+ | Possible (complex) |

#### Implementation Overview

- **Approach:** Optional dependency with clear installation instructions
- **Validation:** Installation checker, compatibility validator
- **Documentation:** Platform-specific guides, troubleshooting

#### Key Components

```python
def check_paddleocr_installation() -> InstallationStatus:
    """
    Check PaddleOCR installation and compatibility.

    Returns:
        InstallationStatus with availability, version, GPU support, issues
    """
    status = InstallationStatus()

    # Check availability
    try:
        import paddleocr
        import paddlepaddle
        status.available = True
        status.paddleocr_version = paddleocr.__version__
        status.paddlepaddle_version = paddlepaddle.__version__
    except ImportError as e:
        status.available = False
        status.error = str(e)
        return status

    # Check Python version compatibility
    if sys.version_info[:2] == (3, 12):
        status.warnings.append(
            "Python 3.12 support is recent. "
            "Please report any issues to ragged project."
        )

    # Check GPU availability
    try:
        status.gpu_available = paddlepaddle.is_compiled_with_cuda()
        if status.gpu_available:
            status.gpu_count = paddlepaddle.device.cuda.device_count()
    except Exception:
        status.gpu_available = False

    # Check models
    status.models_downloaded = check_models_downloaded()

    return status


def suggest_installation_command() -> str:
    """Suggest platform-specific installation command"""
    if sys.platform == 'linux':
        return "pip install paddleocr paddlepaddle"
    elif sys.platform == 'darwin':
        return (
            "# Install Xcode CLI tools first:\n"
            "xcode-select --install\n\n"
            "# Then install PaddleOCR:\n"
            "pip install paddleocr paddlepaddle"
        )
    elif sys.platform == 'win32':
        return (
            "# Install Visual Studio Build Tools first:\n"
            "# https://visualstudio.microsoft.com/downloads/#build-tools-for-visual-studio-2022\n\n"
            "# Then install PaddleOCR:\n"
            "pip install paddleocr paddlepaddle"
        )
```

---

## Implementation Phases

### Phase 1: Installation & Validation (3h)

**Session 1:**

#### Installation Framework (3h)
- Add paddleocr and paddlepaddle as optional dependencies in pyproject.toml:
  ```toml
  [project.optional-dependencies]
  ocr = [
      "paddleocr>=2.9.0",
      "paddlepaddle>=3.0.0"
  ]
  ```
- Implement `check_paddleocr_installation()` function
- Implement platform-specific installation guides
- Add CLI command: `ragged check-dependencies --ocr`
- Validate installation on all platforms (Linux, macOS, Windows if possible)
- Document installation process thoroughly
- Create troubleshooting guide for common issues

**Deliverables:**
- Optional dependency configuration
- Installation checker
- Platform-specific guides
- Troubleshooting documentation

---

### Phase 2: PaddleOCR Processor Implementation (10h)

**Sessions 2-4:**

#### Session 2: Basic Implementation (4h)
- Create `src/processing/paddleocr_processor.py`
- Implement conditional import pattern (`PADDLEOCR_AVAILABLE`)
- Implement `PaddleOCRProcessor` class skeleton
- Implement `BaseProcessor` interface methods
- PDF to image conversion (page by page)
- Basic PaddleOCR invocation
- Unit tests for basic functionality (mocked PaddleOCR)

**Deliverables:**
- Basic PaddleOCR processor
- Conditional import working
- Basic OCR functionality

#### Session 3: OCR Pipeline (3h)
- Implement image preprocessing (contrast, noise reduction, binarisation)
- Implement PaddleOCR pipeline (detection → angle classification → recognition)
- Implement structure recovery (group text into blocks, paragraphs)
- Convert OCR results to markdown format
- Handle rotated text (angle classification)
- Unit tests for OCR pipeline

**Deliverables:**
- Complete OCR pipeline
- Preprocessing working
- Rotated text handling
- Markdown conversion

#### Session 4: Configuration & Optimisation (3h)
- Language configuration (support 80+ languages)
- GPU vs CPU selection
- Model caching and management
- Batch processing optimisation
- Error handling (model download failures, OCR errors)
- Performance tuning (preprocessing thresholds, confidence scores)
- Integration tests with real documents

**Deliverables:**
- Language support configured
- GPU/CPU selection working
- Model management robust
- Performance optimised

---

### Phase 3: Router Integration (2h)

**Session 5:**

#### Multi-Processor Routing (2h)
- Register PaddleOCR processor in `ProcessorFactory`
- Update `ProcessorRouter` to route to PaddleOCR when:
  - Quality score < 0.70 (low quality)
  - PaddleOCR is installed (graceful fallback if not)
  - Rotated content detected
  - User explicitly requests PaddleOCR
- Add fallback chain: PaddleOCR failure → Docling aggressive mode
- Update routing metadata to track PaddleOCR usage
- Integration tests for multi-processor routing

**Deliverables:**
- PaddleOCR registered in factory
- Multi-processor routing working
- Fallback chain complete
- Integration tests passing

---

### Phase 4: Testing & Validation (2-3h)

**Session 6:**

#### Comprehensive Testing (2-3h)
- Expand test corpus:
  - Heavily degraded scanned documents
  - Rotated text (90°, 180°, 270°)
  - Low-resolution scans
  - Multilingual documents
  - Handwritten annotations
- Compare PaddleOCR vs Docling on difficult documents
- Validate angle classification accuracy
- Performance benchmarking (OCR speed, memory usage)
- Edge case testing (empty pages, pure images, corrupted scans)
- Validate graceful degradation (PaddleOCR not installed)

**Deliverables:**
- Complete test corpus
- Quality comparison (PaddleOCR vs Docling on difficult docs)
- Performance benchmarks
- Graceful degradation validated

---

### Phase 5: Documentation & Release (1-2h)

**Session 7:**

#### Documentation (1h)
- User guide: "Installing and Using PaddleOCR"
- Platform-specific installation guides (Linux, macOS, Windows)
- Language configuration guide
- GPU setup guide (optional)
- Troubleshooting guide (common issues, error messages)
- Performance tuning guide
- Update README with PaddleOCR capabilities

**Deliverables:**
- Complete installation guides
- User documentation
- Troubleshooting guide

#### Release Preparation (1h)
- Final testing pass (all tests passing)
- Create release notes for v0.3.4c
- Update CHANGELOG.md
- Tag v0.3.4c release (or v0.3.4 combined release)
- Prepare announcement (highlight optional nature, use cases)

**Deliverables:**
- Release notes
- Tagged release
- Announcement

---

## Technical Architecture

### Directory Structure

```
src/processing/
├── paddleocr_processor.py      # PaddleOCR processor (400 lines)
│   ├── PADDLEOCR_AVAILABLE (global)
│   ├── class PaddleOCRProcessor(BaseProcessor)
│   ├── def check_paddleocr_installation()
│   └── def suggest_installation_command()
├── preprocessor.py             # Image preprocessing (200 lines)
│   └── class ImagePreprocessor
└── installation_checker.py     # Dependency validation (150 lines)
    └── class InstallationChecker

tests/processing/
├── test_paddleocr_processor.py # PaddleOCR tests (mocked)
├── test_paddleocr_integration.py # Real PaddleOCR tests (optional)
├── test_preprocessor.py        # Preprocessing tests
├── test_installation.py        # Installation checker tests
└── fixtures/
    └── difficult_documents/    # Degraded, rotated, multilingual PDFs
```

### Conditional Import Pattern

```python
# src/processing/paddleocr_processor.py

import logging
from pathlib import Path
from typing import Optional

from .base import BaseProcessor, ProcessedDocument, ProcessorConfig

logger = logging.getLogger(__name__)

# Conditional import
try:
    from paddleocr import PaddleOCR
    import paddlepaddle
    PADDLEOCR_AVAILABLE = True
    logger.info("PaddleOCR available")
except ImportError as e:
    PADDLEOCR_AVAILABLE = False
    logger.info(
        f"PaddleOCR not available: {e}. "
        "Install with: pip install 'ragged[ocr]'"
    )
    # Define dummy class for type hints
    PaddleOCR = None


class PaddleOCRProcessor(BaseProcessor):
    """
    PaddleOCR-based processor for challenging documents.

    Requires optional 'ocr' dependencies:
        pip install 'ragged[ocr]'

    Specialises in:
    - Degraded scanned documents
    - Rotated text (automatic angle correction)
    - Low-resolution scans
    - Multilingual documents (80+ languages)
    """

    def __init__(self, config: ProcessorConfig):
        super().__init__(config)

        # Check availability
        if not PADDLEOCR_AVAILABLE:
            raise ImportError(
                "PaddleOCR not installed. Install with: "
                "pip install 'ragged[ocr]'\n\n"
                f"{suggest_installation_command()}"
            )

        # Initialise PaddleOCR
        self.ocr = PaddleOCR(
            use_angle_cls=True,
            lang=config.options.get('lang', 'en'),
            use_gpu=config.options.get('use_gpu', False),
            show_log=False,
            det_model_dir=str(config.model_cache_dir / 'paddle' / 'det'),
            rec_model_dir=str(config.model_cache_dir / 'paddle' / 'rec'),
            cls_model_dir=str(config.model_cache_dir / 'paddle' / 'cls'),
        )

        self.preprocessor = ImagePreprocessor(config)
```

### Image Preprocessing Pipeline

```python
class ImagePreprocessor:
    """Preprocess images for better OCR accuracy"""

    def preprocess(self, image: np.ndarray, options: dict) -> np.ndarray:
        """
        Apply preprocessing pipeline.

        Steps:
        1. Contrast enhancement (CLAHE)
        2. Noise reduction (bilateral filter)
        3. Binarisation (adaptive threshold)
        4. Optional deskewing (if needed)
        """
        processed = image.copy()

        # Convert to greyscale
        if len(processed.shape) == 3:
            grey = cv2.cvtColor(processed, cv2.COLOR_BGR2GRAY)
        else:
            grey = processed

        # Contrast enhancement (CLAHE)
        if options.get('enhance_contrast', True):
            clahe = cv2.createCLAHE(clipLimit=2.0, tileGridSize=(8, 8))
            grey = clahe.apply(grey)

        # Noise reduction (bilateral filter preserves edges)
        if options.get('reduce_noise', True):
            grey = cv2.bilateralFilter(grey, 9, 75, 75)

        # Binarisation (adaptive threshold)
        if options.get('binarise', True):
            grey = cv2.adaptiveThreshold(
                grey, 255,
                cv2.ADAPTIVE_THRESH_GAUSSIAN_C,
                cv2.THRESH_BINARY,
                11, 2
            )

        # Optional deskewing (PaddleOCR handles rotation, but not skew)
        if options.get('deskew', False):
            grey = self._deskew(grey)

        return grey
```

### Multi-Processor Routing (Updated)

```python
class ProcessorRouter:
    """Routes documents to optimal processor (v0.3.4c version)"""

    def _select_processor(self, quality: QualityAssessment) -> str:
        """
        Select processor based on quality assessment.

        Routing rules:
        - High quality (>0.85): Docling (fast, accurate)
        - Medium quality (0.70-0.85): Docling aggressive mode
        - Low quality (<0.70):
            - If rotated content: PaddleOCR (unique capability)
            - Else if PaddleOCR installed: PaddleOCR (better for degraded)
            - Else: Docling max effort (fallback)
        """
        # High quality: Docling is best
        if quality.overall_score > 0.85:
            return "docling"

        # Low quality with rotation: PaddleOCR required
        if quality.has_rotated_content and "paddleocr" in self.processors:
            logger.info("Routing to PaddleOCR (rotated content detected)")
            return "paddleocr"

        # Low quality: PaddleOCR if available
        if quality.overall_score < 0.70:
            if "paddleocr" in self.processors:
                logger.info("Routing to PaddleOCR (low quality score)")
                return "paddleocr"
            else:
                logger.warning(
                    "Low quality document but PaddleOCR not installed. "
                    "Consider installing with: pip install 'ragged[ocr]' "
                    "for better results on degraded documents."
                )
                return "docling"  # Fallback

        # Medium quality: Docling aggressive mode
        return "docling"
```

---

## Risk Analysis & Mitigation

### Technical Risks

| Risk | Impact | Probability | Mitigation | Detection |
|------|--------|------------|------------|-----------|
| Python 3.12 incompatibility | High | Low | Thorough testing, fallback to Docling, clear error messages | CI tests, user reports |
| Installation failures (C++ deps) | High | Medium | Platform-specific guides, troubleshooting docs, installation checker | Installation checker, user feedback |
| Model download failures | Medium | Low | Retry logic, manual download option, cached models | Model manager tests |
| Performance too slow (OCR) | Medium | Medium | GPU support, preprocessing optimisation, warn users of speed | Performance benchmarks |
| Accuracy not better than Docling | Medium | Low | Use only for difficult documents, validate on test corpus | Quality comparison tests |

### Mitigation Strategies

**Installation Complexity:**
```python
def guided_installation():
    """Interactive installation guide"""
    print("PaddleOCR Installation Guide")
    print("=" * 40)

    # Detect platform
    platform = detect_platform()
    print(f"Platform detected: {platform}")

    # Check prerequisites
    if not check_prerequisites():
        print("\nMissing prerequisites:")
        print_prerequisite_installation(platform)
        return

    # Install PaddleOCR
    print("\nInstalling PaddleOCR...")
    try:
        subprocess.run(
            [sys.executable, "-m", "pip", "install", "ragged[ocr]"],
            check=True
        )
        print("✓ Installation successful!")
    except subprocess.CalledProcessError:
        print("✗ Installation failed. See troubleshooting guide:")
        print("  https://ragged.readthedocs.io/en/latest/paddleocr-troubleshooting/")
```

**Graceful Degradation:**
```python
def process_with_fallback(file_path: Path) -> ProcessedDocument:
    """Process with fallback chain"""
    route = router.route(file_path)

    # Try primary processor
    try:
        processor = factory.create(route.processor, route.config)
        return processor.process(file_path)
    except ImportError as e:
        # PaddleOCR not installed
        logger.warning(f"Primary processor unavailable: {e}")
        logger.info("Falling back to Docling aggressive mode")

        # Fallback to Docling
        fallback_config = ProcessorConfig(
            processor_type="docling",
            aggressive_mode=True
        )
        processor = factory.create("docling", fallback_config)
        return processor.process(file_path)
```

---

## Quality Gates

### Functional Requirements

- [ ] PaddleOCR processor implements `BaseProcessor` interface
- [ ] Conditional import works (graceful when PaddleOCR not installed)
- [ ] PDF to image conversion works for all page types
- [ ] Image preprocessing improves OCR accuracy (validated)
- [ ] Angle classification detects and corrects rotated text (0°, 90°, 180°, 270°)
- [ ] OCR results converted to structured markdown
- [ ] Language configuration supports multiple languages
- [ ] GPU/CPU selection works correctly
- [ ] Router selects PaddleOCR for low-quality and rotated documents
- [ ] Fallback chain works (PaddleOCR → Docling)

### Performance Requirements

- [ ] OCR processing completes within reasonable time (10-30s per 100 pages)
- [ ] GPU acceleration works when available (5-10× speedup)
- [ ] Memory usage <3GB for 100-page document
- [ ] Model downloads show progress indicators
- [ ] Preprocessing adds <500ms per page

### Quality Requirements

- [ ] PaddleOCR outperforms Docling on degraded documents (manual validation)
- [ ] Rotated text extracted correctly (>95% accuracy)
- [ ] Multilingual documents processed correctly
- [ ] OCR accuracy >90% on test corpus (degraded documents)
- [ ] Graceful degradation works (no PaddleOCR failures when not installed)

### Code Quality Requirements

- [ ] 90%+ test coverage (challenging with optional dependency)
- [ ] All unit tests passing (mocked PaddleOCR)
- [ ] Integration tests passing (with real PaddleOCR, if available)
- [ ] Type hints complete (mypy strict mode)
- [ ] Docstrings complete (British English, Google style)
- [ ] No pylint warnings (score >9.5)

---

## Execution Checklist

### Pre-Implementation

- [ ] Create feature branch: `git checkout -b feature/v0.3.4c-paddleocr`
- [ ] Ensure v0.3.4a and v0.3.4b completed
- [ ] Research PaddleOCR documentation thoroughly
- [ ] Test PaddleOCR installation on available platforms
- [ ] Design preprocessing pipeline (use architecture-advisor agent)

### Installation & Validation

- [ ] Add optional dependencies to pyproject.toml (`[ocr]` extra)
- [ ] Implement `check_paddleocr_installation()` function
- [ ] Implement `suggest_installation_command()` function
- [ ] Add CLI command: `ragged check-dependencies --ocr`
- [ ] Test installation on Linux (primary)
- [ ] Test installation on macOS (if available)
- [ ] Document Windows installation (if Windows available for testing)
- [ ] Create platform-specific installation guides
- [ ] Create troubleshooting guide

### PaddleOCR Processor Implementation

- [ ] Create `src/processing/paddleocr_processor.py`
- [ ] Implement conditional import pattern
- [ ] Implement `PaddleOCRProcessor` class
- [ ] Implement `BaseProcessor` interface methods
- [ ] PDF to image conversion (page by page)
- [ ] Basic PaddleOCR invocation
- [ ] Unit tests with mocked PaddleOCR
- [ ] Create `src/processing/preprocessor.py`
- [ ] Implement contrast enhancement (CLAHE)
- [ ] Implement noise reduction (bilateral filter)
- [ ] Implement binarisation (adaptive threshold)
- [ ] Implement deskewing (optional)
- [ ] Unit tests for preprocessing
- [ ] Implement OCR pipeline (detection → angle → recognition)
- [ ] Implement rotated text handling
- [ ] Implement structure recovery (blocks, paragraphs)
- [ ] Convert OCR results to markdown
- [ ] Language configuration
- [ ] GPU/CPU selection
- [ ] Model caching and management
- [ ] Integration tests with real documents

### Router Integration

- [ ] Register PaddleOCR in `ProcessorFactory`
- [ ] Update `ProcessorRouter._select_processor()` for multi-processor routing
- [ ] Add PaddleOCR routing conditions (quality < 0.70, rotated content)
- [ ] Implement fallback chain (PaddleOCR → Docling)
- [ ] Update routing metadata
- [ ] Integration tests for multi-processor routing
- [ ] Test graceful degradation (PaddleOCR not installed)

### Testing & Validation

- [ ] Expand test corpus (degraded, rotated, multilingual documents)
- [ ] Compare PaddleOCR vs Docling on difficult documents
- [ ] Validate angle classification (rotated text accuracy >95%)
- [ ] Validate multilingual support
- [ ] Performance benchmarking (OCR speed, memory usage)
- [ ] GPU vs CPU performance comparison
- [ ] Edge case testing (empty pages, pure images, corrupted scans)
- [ ] Validate graceful degradation thoroughly

### Documentation

- [ ] User guide: "Installing and Using PaddleOCR"
- [ ] Platform-specific installation (Linux, macOS, Windows)
- [ ] Language configuration guide
- [ ] GPU setup guide
- [ ] Troubleshooting guide (common installation issues, OCR errors)
- [ ] Performance tuning guide
- [ ] Update README with PaddleOCR capabilities
- [ ] Run documentation-auditor agent

### Release

- [ ] Final testing pass (all tests passing)
- [ ] Create release notes for v0.3.4c (or combined v0.3.4)
- [ ] Update CHANGELOG.md
- [ ] Use git-documentation-committer agent
- [ ] Tag v0.3.4c release (or v0.3.4 if combined)
- [ ] Prepare announcement (emphasise optional nature, use cases)

### Post-Implementation

- [ ] Update implementation record
- [ ] Record actual hours vs estimate (time-log)
- [ ] Document quality improvements (benchmarks, difficult documents)
- [ ] Document lessons learned (devlog)
- [ ] Update v0.3.4/README.md progress
- [ ] Collect user feedback on PaddleOCR usage and installation

---

## Agent Workflow (3-4h)

1. **architecture-advisor (1h):** Preprocessing pipeline design, routing strategy validation for multi-processor
2. **documentation-architect (1h):** Installation guides structure, platform-specific documentation planning
3. **documentation-auditor (1h):** Documentation review
4. **git-documentation-committer (1h):** Final commit with quality checks

---

## Deliverables

1. **PaddleOCR Processor** - Production-ready OCR processor for challenging documents
2. **Image Preprocessing** - Contrast enhancement, noise reduction, binarisation pipeline
3. **Rotated Text Handling** - Automatic angle detection and correction (unique PaddleOCR capability)
4. **Multi-Processor Routing** - Intelligent routing between Docling and PaddleOCR based on quality
5. **Optional Installation** - Graceful degradation when PaddleOCR not installed
6. **Multilingual Support** - 80+ languages configured and tested
7. **Documentation** - Complete installation guides (platform-specific), troubleshooting, usage guides
8. **Complete v0.3.4** - Modern document processing fully implemented (Docling + Routing + PaddleOCR)

---

## Success Criteria

- ✅ PaddleOCR processor handles degraded documents better than Docling (manual validation)
- ✅ Rotated text extracted correctly with >95% accuracy (0°, 90°, 180°, 270°)
- ✅ Multilingual documents processed correctly (tested on 5+ languages)
- ✅ Installation works on Linux and macOS (documented for Windows)
- ✅ Graceful degradation works flawlessly (no errors when PaddleOCR not installed)
- ✅ Router routes to PaddleOCR only for appropriate documents (quality < 0.70 or rotated)
- ✅ GPU acceleration provides 5-10× speedup (when available)
- ✅ All tests passing (90%+ coverage with mocked and real PaddleOCR tests)
- ✅ Documentation complete and approved by auditor
- ✅ v0.3.4 complete: Docling (v0.3.4a) + Routing (v0.3.4b) + PaddleOCR (v0.3.4c)

---

## Related Documentation

- [v0.3.4 Implementation Plan](../../../planning/version/v0.3.4-implementation-plan.md) - Overall strategy and analysis
- [v0.3.4a Roadmap](./v0.3.4a.md) - Prerequisite: Docling core integration
- [v0.3.4b Roadmap](./v0.3.4b.md) - Prerequisite: Intelligent routing
- [v0.3.4 Overview](../v0.3.4.md) - Combined version roadmap

---

**Status:** Planned
