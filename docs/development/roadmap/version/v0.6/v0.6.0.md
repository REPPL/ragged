# v0.6.0: Query Optimisation - Context & Classification

**Focus:** Intelligent context adaptation and query type detection

**Hours:** 40-50 hours

**Dependencies:** v0.5.x (Vision integration complete)

**Status:** Planned

---

## Overview

Version 0.6.0 introduces intelligent query optimisation through dynamic context scope management and automatic query classification. This version optimises token usage and prepares the foundation for intelligent model routing.

**What This Version Delivers:**
- OPTIMISE-001: Context Scope Management (15-20h)
- OPTIMISE-002: Query Classification (25-30h)

**Why This Version is Critical:**
- Reduces token usage by 30-50% for simple queries
- Enables query-appropriate processing strategies
- Foundation for intelligent model routing (v0.6.1)

---

## Features

### OPTIMISE-001: Context Scope Management (15-20 hours)

**Purpose:** Dynamically adjust context scope based on query complexity.

**Context Scopes:**
- **Narrow:** Simple factual queries (last 7 days, top 5 docs)
- **Medium:** Standard queries (last 30 days, topic graph, top 15 docs)
- **Broad:** Complex analytical queries (full timeline, full graph, top 30 docs)

**Implementation:**
- ContextScopeManager with query complexity analysis
- Context compression strategies (chain-of-context, entity-focused, time-windowed)
- Automatic scope selection and recommendation

**Success Criteria:**
- [ ] 30-50% token reduction on simple queries
- [ ] No accuracy loss across all scopes
- [ ] Context scope selection accurate >85%

---

### OPTIMISE-002: Query Classification (25-30 hours)

**Purpose:** Automatically detect query type and intent for appropriate processing.

**Query Types:**
- Factual: "What is X?"
- Analytical: "Compare X and Y"
- Creative: "Suggest improvements to X"
- Visual: "Show me documents with charts"

**Implementation:**
- QueryClassifier for query type detection
- Query complexity scoring algorithm
- Query intent detection (factual, analytical, creative)
- Classification metadata storage

**Success Criteria:**
- [ ] Query classification accuracy >85%
- [ ] Intent detection enables appropriate strategies
- [ ] Classification overhead <50ms

---

## Implementation Checklist

- [ ] **OPTIMISE-001** (15-20h): Context Scope Management
  - [ ] Research context compression techniques
  - [ ] Create ContextScopeManager class
  - [ ] Implement context selection strategies
  - [ ] Add context compression
  - [ ] Testing and validation

- [ ] **OPTIMISE-002** (25-30h): Query Classification
  - [ ] Research classification approaches
  - [ ] Create QueryClassifier class
  - [ ] Implement complexity scoring
  - [ ] Add intent detection
  - [ ] Classification metadata storage
  - [ ] Testing and validation

---

## Files Created

**New Files (~1,050 lines):**
- `src/context/scope_manager.py` (~250 lines)
- `src/context/compression.py` (~200 lines)
- `src/classification/query_classifier.py` (~300 lines)
- `tests/context/test_scope_manager.py` (~150 lines)
- `tests/classification/test_query_classifier.py` (~150 lines)

---

## Success Criteria

**Performance:**
- [ ] 30-50% token reduction for simple queries
- [ ] Classification overhead <50ms
- [ ] No accuracy regression

**Quality:**
- [ ] Context scope selection >85% accurate
- [ ] Query classification >85% accurate
- [ ] Manual testing validates appropriate scopes

---

## Related Documentation

**Full Implementation:**
- [v0.6.x Overview](./README.md) - Complete OPTIMISE-001 and OPTIMISE-002 details

**Context:**
- [v0.5.x Overview](../v0.5/README.md) - Vision integration foundation

**Next Steps:**
- [v0.6.1: Model Intelligence](./v0.6.1.md) - Model routing and domain adaptation

---

**Status:** Planned - First optimisation version
